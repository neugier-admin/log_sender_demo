<decoder name="h3c-realhostname-parent">
  <prematch type="pcre2">^\S+.*\s+%</prematch>
</decoder>

<decoder name="h3c-sshs-auth-success">
  <parent>h3c-realhostname-parent</parent>
  <prematch type="pcre2">SSHS_AUTH_SUCCESS: SSH user </prematch>
  <regex type="pcre2">^(.+?)\s+%(\d+)(\S+)\/(\d+)\/(SSHS_AUTH_SUCCESS):\s+(SSH user (\S+) from (\S+) port (\d+) passed password authentication\.*)$</regex>
  <order>h3c.hostname, h3c.logid_prefix, h3c.module, h3c.severity, h3c.status, data, h3c.user, h3c.srcip, h3c.srcport</order>
  <field name="user">h3c.user</field>
  <field name="srcip">h3c.srcip</field>
  <field name="srcport">h3c.srcport</field>
</decoder>

<decoder name="h3c-sshs-connect">
  <parent>h3c-realhostname-parent</parent>
  <prematch type="pcre2">SSHS_CONNECT: SSH user </prematch>
  <regex type="pcre2">^(.+?)\s+%(\d+)(\S+)\/(\d+)\/(SSHS_CONNECT):\s+(SSH user (\S+) \(IP: (\S+)\) connected to the server successfully\.*)$</regex>
  <order>h3c.hostname, h3c.logid_prefix, h3c.module, h3c.severity, h3c.status, data, h3c.user, h3c.srcip</order>
  <field name="user">h3c.user</field>
  <field name="srcip">h3c.srcip</field>
</decoder>

<decoder name="h3c-shell-login">
  <parent>h3c-realhostname-parent</parent>
  <prematch type="pcre2">SHELL_LOGIN: \S+ logged in from </prematch>
  <regex type="pcre2">^(.+?)\s+%(\d+)(\S+)\/(\d+)\/(SHELL_LOGIN):\s+((\S+) logged in from (\S+)\.*)$</regex>
  <order>h3c.hostname, h3c.logid_prefix, h3c.module, h3c.severity, h3c.status, data, h3c.user, h3c.srcip</order>
  <field name="user">h3c.user</field>
  <field name="srcip">h3c.srcip</field>
</decoder>

<decoder name="h3c-sshs-auth-fail">
  <parent>h3c-realhostname-parent</parent>
  <prematch type="pcre2">SSHS_AUTH_PWD_FAIL: Authentication failed for user </prematch>
  <regex type="pcre2">^(.+?)\s+%(\d+)(\S+)\/(\d+)\/(SSHS_AUTH_PWD_FAIL):\s+(Authentication failed for user (\S+) from (\S+) port (\d+) because of .*)$</regex>
  <order>h3c.hostname, h3c.logid_prefix, h3c.module, h3c.severity, h3c.status, data, h3c.user, h3c.srcip, h3c.srcport</order>
  <field name="user">h3c.user</field>
  <field name="srcip">h3c.srcip</field>
  <field name="srcport">h3c.srcport</field>
</decoder>
