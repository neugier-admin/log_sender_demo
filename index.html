<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wazuh Log Sender Console</title>
    <style>
        /* --- EMBEDDED TAILWIND CSS & CUSTOM STYLES --- */
        
        /* Basic Reset */
        *, ::before, ::after {
            box-sizing: border-box;
            border-width: 0;
            border-style: solid;
            border-color: #e5e7eb; /* Default border color */
        }
        html {
            line-height: 1.5;
            -webkit-text-size-adjust: 100%;
            -moz-tab-size: 4;
            tab-size: 4;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
        }
        body {
            margin: 0;
            line-height: inherit;
        }

        /* Custom Styles & Animations */
        .log-card {
            transition: all 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
        }
        .log-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #2d3748; }
        ::-webkit-scrollbar-thumb { background: #4a5568; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #718096; }
        .tab-button { 
            transition: all 0.2s ease-in-out;
            background-color: transparent;
        }
        .status-dot-connected { background-color: #22c55e; }
        .status-dot-disconnected { background-color: #ef4444; }
        .status-text-connected { color: #4ade80; }
        .status-text-disconnected { color: #f87171; }

        /* Generated Tailwind Classes */
        .bg-black { background-color: #000; }
        .bg-blue-600 { background-color: #2563eb; }
        .bg-cyan-600 { background-color: #0891b2; }
        .bg-gray-700 { background-color: #374151; }
        .bg-gray-800 { background-color: #1f2937; }
        .bg-gray-900 { background-color: #111827; }
        .bg-purple-600 { background-color: #9333ea; }
        .border { border-width: 1px; }
        .border-b { border-bottom-width: 1px; }
        .border-b-2 { border-bottom-width: 2px; }
        .border-l-4 { border-left-width: 4px; }
        .border-cyan-400 { border-color: #22d3ee; }
        .border-cyan-500 { border-color: #06b6d4; }
        .border-gray-600 { border-color: #4b5563; }
        .border-gray-700 { border-color: #374151; }
        .border-transparent { border-color: transparent; }
        .block { display: block; }
        .flex { display: flex; }
        .grid { display: grid; }
        .hidden { display: none; }
        .flex-col { flex-direction: column; }
        .flex-grow { flex-grow: 1; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }
        .font-bold { font-weight: 700; }
        .font-mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
        .font-semibold { font-weight: 600; }
        .h-24 { height: 6rem; }
        .h-3 { height: 0.75rem; }
        .h-48 { height: 12rem; }
        .min-h-screen { min-height: 100vh; }
        .max-w-4xl { max-width: 56rem; }
        .mb-1 { margin-bottom: 0.25rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mt-1 { margin-top: 0.25rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-3 { margin-top: 0.75rem; }
        .mt-4 { margin-top: 1rem; }
        .overflow-y-auto { overflow-y: auto; }
        .p-3 { padding: 0.75rem; }
        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        .pl-3 { padding-left: 0.75rem; }
        .pt-4 { padding-top: 1rem; }
        .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .rounded-full { border-radius: 9999px; }
        .rounded-lg { border-radius: 0.5rem; }
        .rounded-md { border-radius: 0.375rem; }
        .rounded-xl { border-radius: 0.75rem; }
        .shadow-2xl { box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); }
        .space-x-2 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.5rem; }
        .space-x-3 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.75rem; }
        .space-x-4 > :not([hidden]) ~ :not([hidden]) { margin-left: 1rem; }
        .space-y-2 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.5rem; }
        .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 1rem; }
        .space-y-6 > :not([hidden]) ~ :not([hidden]) { margin-top: 1.5rem; }
        .text-center { text-align: center; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }
        .text-cyan-300 { color: #67e8f9; }
        .text-cyan-400 { color: #22d3ee; }
        .text-gray-200 { color: #e5e7eb; }
        .text-gray-300 { color: #d1d5db; }
        .text-gray-400 { color: #9ca3af; }
        .text-gray-500 { color: #6b7280; }
        .text-green-400 { color: #4ade80; }
        .text-purple-400 { color: #c084fc; }
        .text-red-400 { color: #f87171; }
        .text-white { color: #fff; }
        .text-yellow-400 { color: #facc15; }
        .w-3 { width: 0.75rem; }
        .w-full { width: 100%; }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .transition { transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
        .hover\:bg-blue-700:hover { background-color: #1d4ed8; }
        .hover\:bg-cyan-700:hover { background-color: #0e7490; }
        .hover\:bg-gray-700:hover { background-color: #374151; }
        .hover\:bg-purple-700:hover { background-color: #7e22ce; }
        .hover\:text-white:hover { color: #fff; }
        .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse {
            50% { opacity: .5; }
        }

    </style>
</head>
<body class="bg-gray-900 text-gray-200 flex flex-col items-center min-h-screen p-4">

    <div class="w-full max-w-4xl bg-gray-800 rounded-xl shadow-2xl p-6 md:p-8 space-y-6">
        
        <!-- Header -->
        <div class="text-center">
            <h1 class="text-3xl font-bold text-cyan-400">Wazuh Log Sender Console</h1>
            <div class="flex items-center justify-center space-x-4 mt-2">
                 <p class="text-gray-400">For sending log samples to Wazuh Manager for demo purposes.</p>
                 <div id="status-indicator" class="flex items-center space-x-2">
                    <div id="status-dot" class="w-3 h-3 rounded-full status-dot-disconnected"></div>
                    <span id="status-text" class="font-semibold status-text-disconnected">Disconnected</span>
                </div>
            </div>
        </div>

        <!-- Status Console -->
        <div>
            <h2 class="text-xl font-semibold mb-3 text-gray-300 border-l-4 border-cyan-400 pl-3">Status Output</h2>
            <div id="status-console" class="w-full h-48 bg-black rounded-lg p-4 font-mono text-sm overflow-y-auto text-gray-300">
                <p class="text-gray-500">> Waiting for forwarder script connection...</p>
            </div>
             <button onclick="clearConsole()" class="mt-3 text-xs bg-gray-700 hover:bg-gray-600 text-gray-400 py-1 px-3 rounded-md">
                Clear Output
            </button>
        </div>
        
        <!-- Tabbed Interface for Logs and Scenarios -->
        <div>
            <!-- Tab Navigation -->
            <div class="flex border-b border-gray-700">
                <button id="tab-single" onclick="switchTab('single')" class="tab-button py-2 px-6 font-semibold text-white border-b-2 border-cyan-400">Single Log Samples</button>
                <button id="tab-scenarios" onclick="switchTab('scenarios')" class="tab-button py-2 px-6 font-semibold text-gray-500 border-b-2 border-transparent hover:text-white">Alert Scenarios</button>
            </div>

            <!-- Tab Content -->
            <div class="pt-4">
                <!-- Single Log Samples Content -->
                <div id="content-single">
                    <div class="grid grid-cols-2 gap-4">
                       <!-- Juniper Logs First -->
                        <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                            <div class="flex-grow">
                                <p class="font-bold text-green-400">Juniper - Login Success</p>
                                <p class="text-sm text-gray-400 mt-1">Simulates a successful login for the 'root' user.</p>
                            </div>
                            <div class="flex items-center space-x-2 mt-3">
                                <button onclick="sendLog(this, `Oct 17 15:23:57 Juniper-QA-SW mgd[17484]: UI_LOGIN_EVENT: User 'root' login, class 'super-user' fpc0[17484], ssh-connection '', client-mode 'junoscript'`)" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white text-sm py-1 px-3 rounded transition">Send</button>
                                <button onclick="loadToCustom(`Oct 17 15:23:57 Juniper-QA-SW mgd[17484]: UI_LOGIN_EVENT: User 'root' login, class 'super-user' fpc0[17484], ssh-connection '', client-mode 'junoscript'`)" class="w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 text-gray-300 hover:text-white text-sm py-1 px-3 rounded transition">Load to Custom</button>
                            </div>
                        </div>
                         <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                            <div class="flex-grow">
                                <p class="font-bold text-red-400">Juniper - Login Failure</p>
                                <p class="text-sm text-gray-400 mt-1">Simulates a failed login for 'vodatel' user.</p>
                            </div>
                            <div class="flex items-center space-x-2 mt-3">
                                <button onclick="sendLog(this, `Jan 21 04:52:23 Juniper-QA-SW sshd: SSHD_LOGIN_FAILED: Login failed for user 'vodatel' from host '10.255.1.76'`)" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white text-sm py-1 px-3 rounded transition">Send</button>
                                <button onclick="loadToCustom(`Jan 21 04:52:23 Juniper-QA-SW sshd: SSHD_LOGIN_FAILED: Login failed for user 'vodatel' from host '10.255.1.76'`)" class="w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 text-gray-300 hover:text-white text-sm py-1 px-3 rounded transition">Load to Custom</button>
                            </div>
                        </div>
                        <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                            <div class="flex-grow">
                                <p class="font-bold text-white">Juniper - Auth Event</p>
                                <p class="text-sm text-gray-400 mt-1">Simulates a user authentication event.</p>
                            </div>
                            <div class="flex items-center space-x-2 mt-3">
                                <button onclick="sendLog(this, `Oct 17 15:23:57 Juniper-QA-SW mgd[17484]: UI_AUTH_EVENT: Authenticated user 'root' at permission level 'super-user'`)" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white text-sm py-1 px-3 rounded transition">Send</button>
                                <button onclick="loadToCustom(`Oct 17 15:23:57 Juniper-QA-SW mgd[17484]: UI_AUTH_EVENT: Authenticated user 'root' at permission level 'super-user'`)" class="w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 text-gray-300 hover:text-white text-sm py-1 px-3 rounded transition">Load to Custom</button>
                            </div>
                        </div>
                        <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                            <div class="flex-grow">
                                <p class="font-bold text-white">Juniper - Config Mode</p>
                                <p class="text-sm text-gray-400 mt-1">Simulates a user entering configuration mode.</p>
                            </div>
                            <div class="flex items-center space-x-2 mt-3">
                                <button onclick="sendLog(this, `Jan 21 04:51:42 Juniper-QA-SW mgd[14386]: UI_DBBASE_LOGIN_EVENT: User 'root' entering configuration mode`)" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white text-sm py-1 px-3 rounded transition">Send</button>
                                <button onclick="loadToCustom(`Jan 21 04:51:42 Juniper-QA-SW mgd[14386]: UI_DBBASE_LOGIN_EVENT: User 'root' entering configuration mode`)" class="w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 text-gray-300 hover:text-white text-sm py-1 px-3 rounded transition">Load to Custom</button>
                            </div>
                        </div>
                        <!-- H3C Logs Second -->
                         <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                            <div class="flex-grow">
                                <p class="font-bold text-green-400">H3C - Login Success</p>
                                <p class="text-sm text-gray-400 mt-1">Simulates a successful login for 'ccnetwork'.</p>
                            </div>
                            <div class="flex items-center space-x-2 mt-3">
                                <button onclick="sendLog(this, `Oct 17 15:37:59 2025 H3C syslog test SW %10SHELL/5/SHELL_LOGIN: ccnetwork logged in from 10.255.1.70.`)" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white text-sm py-1 px-3 rounded transition">Send</button>
                                <button onclick="loadToCustom(`Oct 17 15:37:59 2025 H3C syslog test SW %10SHELL/5/SHELL_LOGIN: ccnetwork logged in from 10.255.1.70.`)" class="w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 text-gray-300 hover:text-white text-sm py-1 px-3 rounded transition">Load to Custom</button>
                            </div>
                        </div>
                         <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                            <div class="flex-grow">
                                <p class="font-bold text-red-400">H3C - Authentication Failure</p>
                                <p class="text-sm text-gray-400 mt-1">Simulates a password failure for 'ccnetwork'.</p>
                            </div>
                            <div class="flex items-center space-x-2 mt-3">
                                <button onclick="sendLog(this, `Oct 17 15:40:45 2025 H3C syslog test SW %10SSHS/6/SSHS_AUTH_PWD_FAIL: Authentication failed for user ccnetwork from 10.255.1.70 port 52353 because of invalid username or wrong password.`)" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white text-sm py-1 px-3 rounded transition">Send</button>
                                <button onclick="loadToCustom(`Oct 17 15:40:45 2025 H3C syslog test SW %10SSHS/6/SSHS_AUTH_PWD_FAIL: Authentication failed for user ccnetwork from 10.255.1.70 port 52353 because of invalid username or wrong password.`)" class="w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 text-gray-300 hover:text-white text-sm py-1 px-3 rounded transition">Load to Custom</button>
                            </div>
                        </div>
                        <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                            <div class="flex-grow">
                                <p class="font-bold text-white">H3C - Auth Success</p>
                                <p class="text-sm text-gray-400 mt-1">Simulates a successful password authentication.</p>
                            </div>
                            <div class="flex items-center space-x-2 mt-3">
                                <button onclick="sendLog(this, `Oct 17 15:37:57 2025 H3C syslog test SW %10SSHS/6/SSHS_AUTH_SUCCESS: SSH user ccnetwork from 10.255.1.70 port 52353 passed password authentication.`)" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white text-sm py-1 px-3 rounded transition">Send</button>
                                <button onclick="loadToCustom(`Oct 17 15:37:57 2025 H3C syslog test SW %10SSHS/6/SSHS_AUTH_SUCCESS: SSH user ccnetwork from 10.255.1.70 port 52353 passed password authentication.`)" class="w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 text-gray-300 hover:text-white text-sm py-1 px-3 rounded transition">Load to Custom</button>
                            </div>
                        </div>
                        <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                            <div class="flex-grow">
                                <p class="font-bold text-white">H3C - Connect Success</p>
                                <p class="text-sm text-gray-400 mt-1">Simulates a successful SSH connection.</p>
                            </div>
                            <div class="flex items-center space-x-2 mt-3">
                                <button onclick="sendLog(this, `Oct 17 15:37:58 2025 H3C syslog test SW %10SSHS/6/SSHS_CONNECT: SSH user ccnetwork (IP: 10.255.1.70) connected to the server successfully.`)" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white text-sm py-1 px-3 rounded transition">Send</button>
                                <button onclick="loadToCustom(`Oct 17 15:37:58 2025 H3C syslog test SW %10SSHS/6/SSHS_CONNECT: SSH user ccnetwork (IP: 10.255.1.70) connected to the server successfully.`)" class="w-full bg-gray-800 hover:bg-gray-700 border border-gray-600 text-gray-300 hover:text-white text-sm py-1 px-3 rounded transition">Load to Custom</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Alert Scenarios Content -->
                <div id="content-scenarios" class="hidden">
                    <div class="grid grid-cols-2 gap-6">
                        <!-- Left Column: Juniper -->
                        <div class="space-y-4">
                            <h3 class="text-lg font-semibold text-center text-gray-300">Juniper Scenarios</h3>
                            <!-- Brute Force Card -->
                            <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                                <div class="flex-grow">
                                    <p class="font-bold text-purple-400">Brute Force Attack</p>
                                    <p class="text-sm text-gray-400 mt-1">Sends 3 failed Juniper login logs in quick succession.</p>
                                </div>
                                <div class="mt-3">
                                    <button onclick="sendJuniperBruteForce(this)" class="w-full bg-purple-600 hover:bg-purple-700 text-white text-sm font-bold py-2 px-3 rounded transition">Run Scenario</button>
                                </div>
                            </div>
                            <!-- Multi-Source Card -->
                            <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                                <div class="flex-grow">
                                    <p class="font-bold text-purple-400">Multi-Source Logins</p>
                                    <p class="text-sm text-gray-400 mt-1">Simulates logins for one user from 3 different source IPs.</p>
                                    <div class="space-y-2 mt-3">
                                        <div>
                                            <label for="juniper-ms-user" class="text-xs text-gray-400">Username</label>
                                            <input type="text" id="juniper-ms-user" value="admin" class="w-full bg-gray-800 border border-gray-600 rounded-md px-2 py-1 text-sm text-gray-200">
                                        </div>
                                        <div>
                                            <label for="juniper-ip-1" class="text-xs text-gray-400">Source IP 1</label>
                                            <input type="text" id="juniper-ip-1" value="10.255.1.76" class="w-full bg-gray-800 border border-gray-600 rounded-md px-2 py-1 text-sm text-gray-200">
                                        </div>
                                        <div>
                                            <label for="juniper-ip-2" class="text-xs text-gray-400">Source IP 2</label>
                                            <input type="text" id="juniper-ip-2" value="192.168.10.25" class="w-full bg-gray-800 border border-gray-600 rounded-md px-2 py-1 text-sm text-gray-200">
                                        </div>
                                        <div>
                                            <label for="juniper-ip-3" class="text-xs text-gray-400">Source IP 3</label>
                                            <input type="text" id="juniper-ip-3" value="10.255.1.88" class="w-full bg-gray-800 border border-gray-600 rounded-md px-2 py-1 text-sm text-gray-200">
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button onclick="sendJuniperMultiSource(this)" class="w-full bg-purple-600 hover:bg-purple-700 text-white text-sm font-bold py-2 px-3 rounded transition">Run Scenario</button>
                                </div>
                            </div>
                        </div>
                        <!-- Right Column: H3C -->
                        <div class="space-y-4">
                           <h3 class="text-lg font-semibold text-center text-gray-300">H3C Scenarios</h3>
                            <!-- Brute Force Card -->
                            <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                                <div class="flex-grow">
                                    <p class="font-bold text-purple-400">Brute Force Attack</p>
                                    <p class="text-sm text-gray-400 mt-1">Sends 3 failed H3C login logs in quick succession.</p>
                                </div>
                                <div class="mt-3">
                                    <button onclick="sendH3cBruteForce(this)" class="w-full bg-purple-600 hover:bg-purple-700 text-white text-sm font-bold py-2 px-3 rounded transition">Run Scenario</button>
                                </div>
                            </div>
                            <!-- Multi-Source Card -->
                            <div class="log-card p-3 bg-gray-700 rounded-lg border border-gray-600">
                                <div class="flex-grow">
                                    <p class="font-bold text-purple-400">Multi-Source Logins</p>
                                    <p class="text-sm text-gray-400 mt-1">Simulates logins for one user from 3 different source IPs.</p>
                                     <div class="space-y-2 mt-3">
                                        <div>
                                            <label for="h3c-ms-user" class="text-xs text-gray-400">Username</label>
                                            <input type="text" id="h3c-ms-user" value="ccnetwork" class="w-full bg-gray-800 border border-gray-600 rounded-md px-2 py-1 text-sm text-gray-200">
                                        </div>
                                        <div>
                                            <label for="h3c-ip-1" class="text-xs text-gray-400">Source IP 1</label>
                                            <input type="text" id="h3c-ip-1" value="10.255.1.70" class="w-full bg-gray-800 border border-gray-600 rounded-md px-2 py-1 text-sm text-gray-200">
                                        </div>
                                        <div>
                                            <label for="h3c-ip-2" class="text-xs text-gray-400">Source IP 2</label>
                                            <input type="text" id="h3c-ip-2" value="192.168.10.25" class="w-full bg-gray-800 border border-gray-600 rounded-md px-2 py-1 text-sm text-gray-200">
                                        </div>
                                        <div>
                                            <label for="h3c-ip-3" class="text-xs text-gray-400">Source IP 3</label>
                                            <input type="text" id="h3c-ip-3" value="10.255.1.88" class="w-full bg-gray-800 border border-gray-600 rounded-md px-2 py-1 text-sm text-gray-200">
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button onclick="sendH3cMultiSource(this)" class="w-full bg-purple-600 hover:bg-purple-700 text-white text-sm font-bold py-2 px-3 rounded transition">Run Scenario</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Custom Log -->
        <div>
            <h2 class="text-xl font-semibold mb-3 text-gray-300 border-l-4 border-cyan-400 pl-3">Custom Log Content</h2>
            <textarea id="custom-log" class="w-full h-24 bg-gray-700 border border-gray-600 rounded-md px-3 py-2 text-gray-200 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition" placeholder="Enter any log you want to send here, or load a default log to edit..."></textarea>
            <button onclick="sendLog(this, document.getElementById('custom-log').value)" class="mt-3 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md transition">
                Send Custom Log
            </button>
        </div>
    </div>

    <script>
        const forwarderUrl = 'http://localhost:8088';
        const customLogTextarea = document.getElementById('custom-log');
        const statusConsole = document.getElementById('status-console');
        const statusDot = document.getElementById('status-dot');
        const statusText = document.getElementById('status-text');

        function switchTab(tabName) {
            const singleTab = document.getElementById('tab-single');
            const scenariosTab = document.getElementById('tab-scenarios');
            const singleContent = document.getElementById('content-single');
            const scenariosContent = document.getElementById('content-scenarios');

            if (tabName === 'single') {
                singleTab.classList.add('text-white', 'border-cyan-400');
                singleTab.classList.remove('text-gray-500', 'border-transparent');
                scenariosTab.classList.add('text-gray-500', 'border-transparent');
                scenariosTab.classList.remove('text-white', 'border-cyan-400');
                singleContent.classList.remove('hidden');
                scenariosContent.classList.add('hidden');
            } else { // 'scenarios'
                scenariosTab.classList.add('text-white', 'border-cyan-400');
                scenariosTab.classList.remove('text-gray-500', 'border-transparent');
                singleTab.classList.add('text-gray-500', 'border-transparent');
                singleTab.classList.remove('text-white', 'border-cyan-400');
                scenariosContent.classList.remove('hidden');
                singleContent.classList.add('hidden');
            }
        }

        function logToConsole(message, type = 'info') {
            const now = new Date().toLocaleTimeString();
            const p = document.createElement('p');
            let typeColor = 'text-gray-300', typePrefix = 'INFO';
            if (type === 'success') { typeColor = 'text-green-400'; typePrefix = 'SUCCESS'; } 
            else if (type === 'error') { typeColor = 'text-red-400'; typePrefix = 'ERROR'; } 
            else if (type === 'sending') { typeColor = 'text-yellow-400'; typePrefix = 'SENDING'; }
            p.innerHTML = `<span class="text-gray-500">${now}</span> <span class="${typeColor} font-bold">[${typePrefix}]</span>: ${message}`;
            statusConsole.appendChild(p);
            statusConsole.scrollTop = statusConsole.scrollHeight;
        }

        function clearConsole() {
            statusConsole.innerHTML = '<p class="text-gray-500">> Output cleared.</p>';
        }

        function loadToCustom(logMessage) {
            customLogTextarea.value = logMessage;
            logToConsole('Log loaded into custom field for editing.', 'info');
            customLogTextarea.focus();
        }

        function getCurrentTimestamp(withYear = false) {
            const now = new Date();
            const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            const month = months[now.getMonth()];
            const day = String(now.getDate()).padStart(2, ' ');
            const timePart = `${month} ${day} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}`;
            return withYear ? `${timePart} ${now.getFullYear()}` : timePart;
        }

        function updateLogTimestamp(logMessage) {
            const h3cRegex = /^(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\d{2}:\d{2}:\d{2}\s+\d{4}/;
            const juniperRegex = /^(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}\s+\d{2}:\d{2}:\d{2}/;
            if (h3cRegex.test(logMessage)) return logMessage.replace(h3cRegex, getCurrentTimestamp(true));
            if (juniperRegex.test(logMessage)) return logMessage.replace(juniperRegex, getCurrentTimestamp(false));
            return logMessage;
        }

        async function performFetch(logMessage) {
            try {
                const response = await fetch(forwarderUrl, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: logMessage });
                return response.ok;
            } catch (error) {
                logToConsole(`Request failed: ${error.message}`, 'error');
                logToConsole(`This could be because the PowerShell forwarder script is not running.`, 'error');
                return false;
            }
        }

        async function sendLog(button, logMessage) {
            if (!logMessage && button.onclick.toString().includes("custom-log")) logMessage = customLogTextarea.value;
            if (!logMessage) { logToConsole('Custom log content cannot be empty!', 'error'); return; }
            
            const updatedLog = updateLogTimestamp(logMessage);
            logToConsole(`Preparing to send...`, 'sending');
            logToConsole(`Log content: <span class="text-cyan-300">${updatedLog}</span>`);
            
            let originalText = '';
            if (button) { button.disabled = true; button.classList.add('animate-pulse'); originalText = button.innerText; button.innerText = 'Sending...'; }
            
            if (await performFetch(updatedLog)) logToConsole(`Log sent successfully!`, 'success');
            
            if (button) { button.disabled = false; button.classList.remove('animate-pulse'); button.innerText = originalText; }
        }

        async function runScenario(button, logTemplates, logGenerator) {
            button.disabled = true;
            const originalText = button.innerText;
            button.innerText = 'Running...';
            
            for (let i = 0; i < logTemplates.length; i++) {
                const logToSend = logGenerator ? logGenerator(logTemplates[i], i) : logTemplates[i];
                const updatedLog = updateLogTimestamp(logToSend);
                logToConsole(`Sending log #${i + 1}...`, 'info');
                logToConsole(`Log content: <span class="text-cyan-300">${updatedLog}</span>`);
                if (!(await performFetch(updatedLog))) { logToConsole('Scenario stopped due to a send error.', 'error'); break; }
                if (i < logTemplates.length - 1) await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            button.disabled = false;
            button.innerText = originalText;
        }
        
        // --- SCENARIO FUNCTIONS ---
        function sendJuniperBruteForce(btn) { 
            logToConsole('Starting Juniper Brute Force scenario...', 'sending');
            const templates = Array(3).fill(`Jan 21 04:52:23 Juniper-QA-SW sshd: SSHD_LOGIN_FAILED: Login failed for user 'vodatel' from host '10.255.1.76'`);
            runScenario(btn, templates).then(() => logToConsole('Juniper Brute Force scenario complete.', 'success'));
        }
        function sendH3cBruteForce(btn) {
            logToConsole('Starting H3C Brute Force scenario...', 'sending');
            const templates = Array(3).fill(`Oct 17 15:40:45 2025 H3C syslog test SW %10SSHS/6/SSHS_AUTH_PWD_FAIL: Authentication failed for user ccnetwork from 10.255.1.70 port 52353 because of invalid username or wrong password.`);
            runScenario(btn, templates).then(() => logToConsole('H3C Brute Force scenario complete.', 'success'));
        }
        function sendJuniperMultiSource(btn) {
            logToConsole('Starting Juniper Multi-Source Login scenario...', 'sending');
            const username = document.getElementById('juniper-ms-user').value;
            const ips = [document.getElementById('juniper-ip-1').value, document.getElementById('juniper-ip-2').value, document.getElementById('juniper-ip-3').value];
            if (ips.some(ip => !ip) || !username) { logToConsole('Username and all three source IPs must be provided!', 'error'); return; }
            const templates = [
                `Oct 17 15:23:57 Juniper-QA-SW mgd[17484]: UI_LOGIN_EVENT: User '${username}' login from host '${ips[0]}', class 'super-user'`,
                `Oct 17 15:24:05 Juniper-QA-SW mgd[17491]: UI_LOGIN_EVENT: User '${username}' login from host '${ips[1]}', class 'super-user'`,
                `Oct 17 15:24:12 Juniper-QA-SW mgd[17498]: UI_LOGIN_EVENT: User '${username}' login from host '${ips[2]}', class 'super-user'`
            ];
            runScenario(btn, templates).then(() => logToConsole('Juniper Multi-Source Login scenario complete.', 'success'));
        }
        function sendH3cMultiSource(btn) {
            logToConsole('Starting H3C Multi-Source Login scenario...', 'sending');
            const username = document.getElementById('h3c-ms-user').value;
            const ips = [document.getElementById('h3c-ip-1').value, document.getElementById('h3c-ip-2').value, document.getElementById('h3c-ip-3').value];
            if (ips.some(ip => !ip) || !username) { logToConsole('Username and all three source IPs must be provided!', 'error'); return; }
            const templates = [
                `Oct 17 15:37:59 2025 H3C syslog test SW %10SHELL/5/SHELL_LOGIN: ${username} logged in from ${ips[0]}.`,
                `Oct 17 15:38:05 2025 H3C syslog test SW %10SHELL/5/SHELL_LOGIN: ${username} logged in from ${ips[1]}.`,
                `Oct 17 15:38:12 2025 H3C syslog test SW %10SHELL/5/SHELL_LOGIN: ${username} logged in from ${ips[2]}.`
            ];
            runScenario(btn, templates).then(() => logToConsole('H3C Multi-Source Login scenario complete.', 'success'));
        }

        // --- Connection Status Check ---
        function updateStatusIndicator(isConnected) {
            if(isConnected) {
                statusDot.classList.remove('status-dot-disconnected');
                statusDot.classList.add('status-dot-connected');
                statusText.classList.remove('status-text-disconnected');
                statusText.classList.add('status-text-connected');
                statusText.textContent = 'Connected';
            } else {
                statusDot.classList.remove('status-dot-connected');
                statusDot.classList.add('status-dot-disconnected');
                statusText.classList.remove('status-text-connected');
                statusText.classList.add('status-text-disconnected');
                statusText.textContent = 'Disconnected';
            }
        }

        async function checkForwarderStatus() {
            try {
                const response = await fetch(forwarderUrl, { method: 'GET' });
                updateStatusIndicator(response.ok);
            } catch (error) {
                updateStatusIndicator(false);
            }
        }
        
        // Initial check and start interval
        checkForwarderStatus();
        setInterval(checkForwarderStatus, 10000); // Check every 10 seconds

    </script>

</body>
</html>

